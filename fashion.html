<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Alumni Connect Demo</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#f9f9f9;color:#222;}
    .hidden{display:none;}
    .screen{display:flex;justify-content:center;align-items:center;height:100vh;}
    .curtain{background:#111;color:#fff;font-size:2rem;flex-direction:column;}
    .auth-box,.dash{background:#fff;padding:20px;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,0.1);}
    input,button{padding:8px;margin:5px;border:1px solid #ccc;border-radius:5px;}
    button{cursor:pointer;}
    h2,h3{margin:10px 0;}
    .chip{display:inline-block;padding:5px 10px;background:#eee;margin:3px;border-radius:15px;cursor:pointer;}
    .tag{background:#ddd;padding:2px 6px;border-radius:10px;font-size:12px;margin-right:3px;}
    .alumni-card{display:flex;align-items:center;background:#fafafa;border:1px solid #ddd;padding:10px;margin:5px;border-radius:8px;cursor:pointer;}
    .avatar{width:40px;height:40px;border-radius:50%;background:#666;color:#fff;display:flex;align-items:center;justify-content:center;margin-right:10px;}
    .modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);display:none;justify-content:center;align-items:center;}
    .modal-card{background:#fff;padding:20px;border-radius:10px;width:300px;position:relative;}
    .close-x{position:absolute;top:5px;right:10px;cursor:pointer;}
    .conn-item{display:flex;align-items:center;background:#fafafa;border:1px solid #ddd;padding:10px;margin:5px;border-radius:8px;}
    .small-btn{padding:5px 10px;font-size:12px;margin-left:5px;}
    .chat-box{border:1px solid #ccc;border-radius:8px;display:flex;flex-direction:column;height:300px;}
    .chat-messages{flex:1;overflow-y:auto;padding:10px;}
    .chat-input{display:flex;}
    .chat-input input{flex:1;}
    .msg{margin:5px 0;padding:5px 8px;border-radius:8px;max-width:70%;}
    .msg.me{background:#d1e7ff;align-self:flex-end;}
    .msg.them{background:#eee;align-self:flex-start;}
    .video-modal{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;}
    .video-card{background:#fff;padding:10px;border-radius:10px;}
    video{width:400px;height:300px;background:#000;}
    .muted{color:#777;font-size:0.9em;}
  </style>
</head>
<body>

<!-- Curtain Intro -->
<div class="screen curtain" id="curtainScreen">
  <div>ðŸŽ“ Welcome to Alumni Connect</div>
  <button id="enterBtn">Enter</button>
</div>

<!-- Auth -->
<div class="screen hidden" id="authScreen">
  <div class="auth-box">
    <h2>Login / Sign Up</h2>
    <input id="authName" placeholder="Your Name"><br>
    <input id="authEmail" placeholder="Email"><br>
    <input id="authPass" type="password" placeholder="Password"><br>
    <button id="loginBtn">Login</button>
    <button id="signupBtn">Create Account</button>
  </div>
</div>

<!-- Dashboard -->
<div class="screen hidden" id="dashScreen">
  <div class="dash">
    <h2 id="welcome"></h2>
    <button onclick="logout()">Logout</button>

    <h3>Profile</h3>
    <div id="profile"></div>

    <h3>Goals</h3>
    <input id="goalInput" placeholder="Add a goal/skill">
    <button id="addGoalBtn">Add</button>
    <div id="goalList"></div>

    <h3>Suggested Alumni</h3>
    <div id="alumniList"></div>

    <h3>Connections</h3>
    <div id="connectionsList"></div>
  </div>
</div>

<!-- Modal -->
<div class="modal" id="modalRoot">
  <div class="modal-card" id="modalCard">
    <span class="close-x" id="modalCloseBtn">âœ–</span>
    <h3 id="modalName"></h3>
    <div id="modalRole" class="muted"></div>
    <p id="modalBio"></p>
    <div id="modalSkills"></div>
    <button id="modalConnectBtn">Connect</button>
    <button id="modalChatBtn">Chat</button>
    <button id="modalVideoBtn">Video</button>
  </div>
</div>

<!-- Video -->
<div class="video-modal" id="videoRoot">
  <div class="video-card">
    <video id="previewVideo" autoplay></video><br>
    <button id="stopCam">Stop Camera</button>
    <button id="closeVideo">Close</button>
  </div>
</div>

<script>
/* ---------------------
   Dummy Alumni Data
   --------------------- */
const ALUMNI_DATA = [
  {id:1,name:"Alice Kumar",role:"Software Engineer",batch:"2018",skills:["c++","web","ai"],bio:"Works at Google in AI research."},
  {id:2,name:"Rahul Singh",role:"Product Manager",batch:"2017",skills:["management","strategy","design"],bio:"PM at Microsoft."},
  {id:3,name:"Meera Iyer",role:"Data Scientist",batch:"2019",skills:["python","ml","data"],bio:"At Amazon ML team."}
];

/* ---------------------
   Storage Helpers
   --------------------- */
function getStoredUser(){ return JSON.parse(localStorage.getItem('user'));}
function setStoredUser(u){ localStorage.setItem('user',JSON.stringify(u)); }
function clearStoredUser(){ localStorage.removeItem('user'); }
function getGoals(){ return JSON.parse(localStorage.getItem('goals')||'[]'); }
function setGoals(g){ localStorage.setItem('goals',JSON.stringify(g)); }
function getConnections(){ return JSON.parse(localStorage.getItem('conns')||'[]'); }
function setConnections(c){ localStorage.setItem('conns',JSON.stringify(c)); }
function getMessages(){ return JSON.parse(localStorage.getItem('msgs')||'{}'); }
function setMessages(m){ localStorage.setItem('msgs',JSON.stringify(m)); }

/* ---------------------
   Navigation
   --------------------- */
document.getElementById('enterBtn').onclick=()=>{showAuth();}
function showAuth(){document.getElementById('curtainScreen').classList.add('hidden');document.getElementById('authScreen').classList.remove('hidden');}
function showDash(){
  document.getElementById('authScreen').classList.add('hidden');
  document.getElementById('dashScreen').classList.remove('hidden');
  renderDashboard();
}

/* ---------------------
   Auth
   --------------------- */
document.getElementById('loginBtn').onclick=()=>{
  const email=document.getElementById('authEmail').value;
  const pass=document.getElementById('authPass').value;
  const user=getStoredUser();
  if(user && user.email===email && user.pass===pass){showDash();}
  else alert('Invalid credentials or no account found.');
};
document.getElementById('signupBtn').onclick=()=>{
  const u={name:document.getElementById('authName').value,email:document.getElementById('authEmail').value,pass:document.getElementById('authPass').value};
  setStoredUser(u); alert('Account created. Please login.');
};

/* ---------------------
   Dashboard
   --------------------- */
function renderDashboard(){
  const u=getStoredUser(); if(!u) return;
  document.getElementById('welcome').textContent='Welcome, '+u.name;
  renderProfile(); renderGoals(); renderAlumniMatches(); renderConnections(); bindDashboardEvents();
}
function renderProfile(){
  const u=getStoredUser();const prof=document.getElementById('profile');prof.innerHTML='';
  const chip=document.createElement('div');chip.className='chip';chip.textContent=u.email;prof.appendChild(chip);
}
function renderGoals(){
  const goals=getGoals();const list=document.getElementById('goalList');list.innerHTML='';
  goals.forEach((g,i)=>{const div=document.createElement('div');div.className='chip';div.textContent=g;
    div.onclick=()=>{setGoals(goals.filter((_,idx)=>idx!==i));renderGoals();renderAlumniMatches();};
    list.appendChild(div);});
}
function renderAlumniMatches(){
  const goals=getGoals().map(g=>g.toLowerCase());const list=document.getElementById('alumniList');list.innerHTML='';
  if(!goals.length){list.innerHTML='<div class="muted">Add goals to see alumni suggestions.</div>';return;}
  const matches=ALUMNI_DATA.filter(al=>al.skills.some(s=>goals.some(g=>s.includes(g))));
  if(!matches.length){list.innerHTML='<div class="muted">No matches yet.</div>';return;}
  matches.forEach(al=>{
    const card=document.createElement('div');card.className='alumni-card';
    card.innerHTML=`<div class="avatar">${al.name[0]}</div><div><b>${al.name}</b><div class="muted">${al.role}</div></div>`;
    card.onclick=()=>openModal(al);list.appendChild(card);
  });
}
function renderConnections(){
  const conns=getConnections();const list=document.getElementById('connectionsList');list.innerHTML='';
  if(!conns.length){list.innerHTML='<div class="muted">No connections yet.</div>';return;}
  conns.forEach(id=>{const al=ALUMNI_DATA.find(a=>a.id===id);if(!al) return;
    const div=document.createElement('div');div.className='conn-item';
    div.innerHTML=`<div class="avatar">${al.name[0]}</div><div style="flex:1"><b>${al.name}</b><div class="muted">${al.role}</div></div>
    <button class="small-btn">Chat</button><button class="small-btn">Video</button>`;
    div.querySelectorAll('button')[0].onclick=()=>openChat(al);div.querySelectorAll('button')[1].onclick=()=>openVideo();list.appendChild(div);
  });
}

/* ---------------------
   Modal
   --------------------- */
function openModal(al){
  const m=document.getElementById('modalRoot');m.style.display='flex';
  document.getElementById('modalName').textContent=al.name;document.getElementById('modalRole').textContent=al.role+' Â· Batch '+al.batch;
  document.getElementById('modalBio').textContent=al.bio;document.getElementById('modalSkills').innerHTML=al.skills.map(s=>`<span class="tag">${s}</span>`).join('');
  document.getElementById('modalConnectBtn').onclick=()=>{const c=getConnections();if(!c.includes(al.id)){c.push(al.id);setConnections(c);renderConnections();alert('Connected with '+al.name);}closeModal();};
  document.getElementById('modalChatBtn').onclick=()=>{closeModal();openChat(al);};
  document.getElementById('modalVideoBtn').onclick=()=>{closeModal();openVideo();};
}
document.getElementById('modalCloseBtn').onclick=closeModal;
function closeModal(){document.getElementById('modalRoot').style.display='none';}

/* ---------------------
   Chat
   --------------------- */
function openChat(al){
  const m=document.getElementById('modalRoot');m.style.display='flex';
  document.getElementById('modalCard').innerHTML=`
    <div><b>Chat with ${al.name}</b></div>
    <div class="chat-box"><div class="chat-messages" id="chatMsgs"></div>
    <div class="chat-input"><input id="chatInput"><button id="sendMsg">Send</button></div></div>
    <button class="close-x" onclick="closeModal()">Close</button>`;
  renderChat(al);document.getElementById('sendMsg').onclick=()=>{const val=document.getElementById('chatInput').value.trim();
    if(!val) return;addMessage(al.id,{from:'me',text:val});document.getElementById('chatInput').value='';renderChat(al);};
}
function renderChat(al){const msgs=getMessages()[al.id]||[];const box=document.getElementById('chatMsgs');if(!box) return;box.innerHTML='';
  msgs.forEach(m=>{const d=document.createElement('div');d.className='msg '+m.from;d.textContent=m.text;box.appendChild(d);});box.scrollTop=box.scrollHeight;}
function addMessage(id,msg){const msgs=getMessages();if(!msgs[id])msgs[id]=[];msgs[id].push(msg);setMessages(msgs);}

/* ---------------------
   Video
   --------------------- */
let stream=null;
function openVideo(){document.getElementById('videoRoot').style.display='flex';const v=document.getElementById('previewVideo');
  navigator.mediaDevices.getUserMedia({video:true,audio:false}).then(s=>{stream=s;v.srcObject=s;}).catch(e=>alert(e));}
document.getElementById('closeVideo').onclick=()=>{stopVideo();document.getElementById('videoRoot').style.display='none';};
document.getElementById('stopCam').onclick=stopVideo;
function stopVideo(){if(stream){stream.getTracks().forEach(t=>t.stop());stream=null;}}

/* ---------------------
   Bind Events
   --------------------- */
function bindDashboardEvents(){
  document.getElementById('addGoalBtn').onclick=()=>{
    const val=document.getElementById('goalInput').value.trim();if(!val)return;
    const g=getGoals();g.push(val);setGoals(g);document.getElementById('goalInput').value='';renderGoals();renderAlumniMatches();
  };
}
function logout(){clearStoredUser();alert('Logged out.');location.reload();}
</script>
</body>
</html>
